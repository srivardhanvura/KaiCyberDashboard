import React from "react";
import {
  LineChart,
  Line,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  ResponsiveContainer,
  Legend,
} from "recharts";
import { Card, CardContent, Typography, Box } from "@mui/material";

interface TrendData {
  date: string;
  critical: number;
  high: number;
  medium: number;
  low: number;
  unknown: number;
}

interface VulnerabilityTrendChartProps {
  data: TrendData[];
  title?: string;
  disableAnimation?: boolean;
}

const VulnerabilityTrendChart: React.FC<VulnerabilityTrendChartProps> = ({
  data,
  title = "Vulnerability Trends Over Time",
  disableAnimation = false,
}) => {
  const formatDate = (dateStr: string) => {
    return new Date(dateStr).toLocaleDateString("en-US", {
      month: "short",
      day: "numeric",
    });
  };

  return (
    <Card sx={{ height: "100%" }}>
      <CardContent>
        <Typography variant="h6" gutterBottom>
          {title}
        </Typography>
        <Box sx={{ height: 300 }}>
          <ResponsiveContainer width="100%" height="100%">
            <LineChart
              data={data}
              margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
            >
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis dataKey="date" tickFormatter={formatDate} fontSize={12} />
              <YAxis />
              <Tooltip
                labelFormatter={(label) => `Date: ${formatDate(label)}`}
                formatter={(value: number, name: string) => [
                  value,
                  name.charAt(0).toUpperCase() + name.slice(1),
                ]}
              />
              <Legend />
              <Line
                type="monotone"
                dataKey="critical"
                stroke="#d32f2f"
                strokeWidth={2}
                name="Critical"
                dot={!disableAnimation}
                isAnimationActive={!disableAnimation}
                connectNulls
              />
              <Line
                type="monotone"
                dataKey="high"
                stroke="#f57c00"
                strokeWidth={2}
                name="High"
                dot={!disableAnimation}
                isAnimationActive={!disableAnimation}
                connectNulls
              />
              <Line
                type="monotone"
                dataKey="medium"
                stroke="#fbc02d"
                strokeWidth={2}
                name="Medium"
                dot={!disableAnimation}
                isAnimationActive={!disableAnimation}
                connectNulls
              />
              <Line
                type="monotone"
                dataKey="low"
                stroke="#388e3c"
                strokeWidth={2}
                name="Low"
                dot={!disableAnimation}
                isAnimationActive={!disableAnimation}
                connectNulls
              />
              <Line
                type="monotone"
                dataKey="unknown"
                stroke="#757575"
                strokeWidth={2}
                name="Unknown"
                dot={!disableAnimation}
                isAnimationActive={!disableAnimation}
                connectNulls
              />
            </LineChart>
          </ResponsiveContainer>
        </Box>
        <Box mt={2}>
          <Typography variant="body2" color="text.secondary">
            Daily vulnerability discovery trends by severity
          </Typography>
        </Box>
      </CardContent>
    </Card>
  );
};

export default VulnerabilityTrendChart;
